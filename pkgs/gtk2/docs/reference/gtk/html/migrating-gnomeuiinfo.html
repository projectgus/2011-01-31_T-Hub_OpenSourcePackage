<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Migrating from GnomeUIInfo</title><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="GTK+ Reference Manual"><link rel="up" href="gtk-migrating-GtkAction.html" title="Migrating from old menu and toolbar systems to GtkAction"><link rel="previous" href="ui-manager.html" title="User Interface Manager Object"><link rel="next" href="gtk-migrating-GtkComboBox.html" title="Migrating from GtkOptionMenu and GtkCombo to GtkComboBox and GtkComboBoxEntry"><link rel="part" href="gtk.html" title="Part I. GTK+ Overview"><link rel="refentry" href="gtk-building.html" title="Compiling the GTK+ libraries"><link rel="refentry" href="gtk-compiling.html" title="Compiling GTK+ Applications"><link rel="refentry" href="gtk-running.html" title="Running GTK+ Applications"><link rel="refentry" href="gtk-windows.html" title="Using GTK+ on Windows"><link rel="refentry" href="gtk-framebuffer.html" title="Using GTK+ on the Framebuffer"><link rel="refentry" href="gtk-x11.html" title="Using GTK+ on the X Window System"><link rel="refentry" href="gtk-resources.html" title="Mailing lists and bug reports"><link rel="refentry" href="gtk-question-index.html" title="Common Questions"><link rel="part" href="gtkbase.html" title="Part II. GTK+ Core Reference"><link rel="refentry" href="gtk-General.html" title="Main loop and Events"><link rel="refentry" href="gtk-Keyboard-Accelerators.html" title="Accelerator Groups"><link rel="refentry" href="gtk-Accelerator-Maps.html" title="Accelerator Maps"><link rel="refentry" href="gtk-Clipboards.html" title="Clipboards"><link rel="refentry" href="gtk-Drag-and-Drop.html" title="Drag and Drop"><link rel="refentry" href="GtkIconTheme.html" title="GtkIconTheme"><link rel="refentry" href="gtk-Stock-Items.html" title="Stock Items"><link rel="refentry" href="gtk-Themeable-Stock-Images.html" title="Themeable Stock Images"><link rel="refentry" href="gtk-Resource-Files.html" title="Resource Files"><link rel="refentry" href="GtkSettings.html" title="Settings"><link rel="refentry" href="gtk-Bindings.html" title="Bindings"><link rel="refentry" href="gtk-Standard-Enumerations.html" title="Standard Enumerations"><link rel="refentry" href="gtk-Graphics-Contexts.html" title="Graphics Contexts"><link rel="refentry" href="GtkStyle.html" title="Styles"><link rel="refentry" href="gtk-Selections.html" title="Selections"><link rel="refentry" href="gtk-Feature-Test-Macros.html" title="Version Information"><link rel="refentry" href="gtk-Signals.html" title="Signals"><link rel="refentry" href="gtk-Types.html" title="Types"><link rel="part" href="gtkobjects.html" title="Part III. GTK+ Widgets and Objects"><link rel="chapter" href="ch01.html" title="Object Hierarchy"><link rel="chapter" href="WindowWidgets.html" title="Windows"><link rel="refentry" href="GtkDialog.html" title="GtkDialog"><link rel="refentry" href="GtkInvisible.html" title="GtkInvisible"><link rel="refentry" href="GtkMessageDialog.html" title="GtkMessageDialog"><link rel="refentry" href="GtkWindow.html" title="GtkWindow"><link rel="refentry" href="GtkWindowGroup.html" title="GtkWindowGroup"><link rel="chapter" href="DisplayWidgets.html" title="Display Widgets"><link rel="refentry" href="GtkAccelLabel.html" title="GtkAccelLabel"><link rel="refentry" href="GtkImage.html" title="GtkImage"><link rel="refentry" href="GtkLabel.html" title="GtkLabel"><link rel="refentry" href="GtkProgressBar.html" title="GtkProgressBar"><link rel="refentry" href="GtkStatusbar.html" title="GtkStatusbar"><link rel="chapter" href="ButtonWidgets.html" title="Buttons and Toggles"><link rel="refentry" href="GtkButton.html" title="GtkButton"><link rel="refentry" href="GtkCheckButton.html" title="GtkCheckButton"><link rel="refentry" href="GtkRadioButton.html" title="GtkRadioButton"><link rel="refentry" href="GtkToggleButton.html" title="GtkToggleButton"><link rel="chapter" href="NumericEntry.html" title="Numeric/Text Data Entry"><link rel="refentry" href="GtkEntry.html" title="GtkEntry"><link rel="refentry" href="GtkEntryCompletion.html" title="GtkEntryCompletion"><link rel="refentry" href="GtkHScale.html" title="GtkHScale"><link rel="refentry" href="GtkVScale.html" title="GtkVScale"><link rel="refentry" href="GtkSpinButton.html" title="GtkSpinButton"><link rel="refentry" href="GtkEditable.html" title="GtkEditable"><link rel="chapter" href="TextWidgetObjects.html" title="Multiline Text Editor"><link rel="refentry" href="TextWidget.html" title="Text Widget Overview"><link rel="refentry" href="gtk-GtkTextIter.html" title="GtkTextIter"><link rel="refentry" href="GtkTextMark.html" title="GtkTextMark"><link rel="refentry" href="GtkTextBuffer.html" title="GtkTextBuffer"><link rel="refentry" href="GtkTextTag.html" title="GtkTextTag"><link rel="refentry" href="GtkTextTagTable.html" title="GtkTextTagTable"><link rel="refentry" href="GtkTextView.html" title="GtkTextView"><link rel="chapter" href="TreeWidgetObjects.html" title="Tree and List Widget"><link rel="refentry" href="TreeWidget.html" title="Tree and List Widget Overview"><link rel="refentry" href="GtkTreeModel.html" title="GtkTreeModel"><link rel="refentry" href="GtkTreeSelection.html" title="GtkTreeSelection"><link rel="refentry" href="GtkTreeViewColumn.html" title="GtkTreeViewColumn"><link rel="refentry" href="GtkTreeView.html" title="GtkTreeView"><link rel="refentry" href="gtk-GtkTreeView-drag-and-drop.html" title="GtkTreeView drag-and-drop"><link rel="refentry" href="GtkTreeSortable.html" title="GtkTreeSortable"><link rel="refentry" href="GtkTreeModelSort.html" title="GtkTreeModelSort"><link rel="refentry" href="GtkTreeModelFilter.html" title="GtkTreeModelFilter"><link rel="refentry" href="GtkCellLayout.html" title="GtkCellLayout"><link rel="refentry" href="GtkCellRenderer.html" title="GtkCellRenderer"><link rel="refentry" href="GtkCellEditable.html" title="GtkCellEditable"><link rel="refentry" href="GtkCellRendererPixbuf.html" title="GtkCellRendererPixbuf"><link rel="refentry" href="GtkCellRendererText.html" title="GtkCellRendererText"><link rel="refentry" href="GtkCellRendererToggle.html" title="GtkCellRendererToggle"><link rel="refentry" href="GtkListStore.html" title="GtkListStore"><link rel="refentry" href="GtkTreeStore.html" title="GtkTreeStore"><link rel="chapter" href="MenusAndCombos.html" title="Menus, Combo Box, Toolbar"><link rel="refentry" href="GtkComboBox.html" title="GtkComboBox"><link rel="refentry" href="GtkComboBoxEntry.html" title="GtkComboBoxEntry"><link rel="refentry" href="GtkMenu.html" title="GtkMenu"><link rel="refentry" href="GtkMenuBar.html" title="GtkMenuBar"><link rel="refentry" href="GtkMenuItem.html" title="GtkMenuItem"><link rel="refentry" href="GtkMenuShell.html" title="GtkMenuShell"><link rel="refentry" href="GtkImageMenuItem.html" title="GtkImageMenuItem"><link rel="refentry" href="GtkRadioMenuItem.html" title="GtkRadioMenuItem"><link rel="refentry" href="GtkCheckMenuItem.html" title="GtkCheckMenuItem"><link rel="refentry" href="GtkSeparatorMenuItem.html" title="GtkSeparatorMenuItem"><link rel="refentry" href="GtkTearoffMenuItem.html" title="GtkTearoffMenuItem"><link rel="refentry" href="GtkToolbar.html" title="GtkToolbar"><link rel="refentry" href="GtkToolItem.html" title="GtkToolItem"><link rel="refentry" href="GtkSeparatorToolItem.html" title="GtkSeparatorToolItem"><link rel="refentry" href="GtkToolButton.html" title="GtkToolButton"><link rel="refentry" href="GtkToggleToolButton.html" title="GtkToggleToolButton"><link rel="refentry" href="GtkRadioToolButton.html" title="GtkRadioToolButton"><link rel="chapter" href="Actions.html" title="Action-based menus and toolbars"><link rel="refentry" href="GtkUIManager.html" title=" 
GtkUIManager"><link rel="refentry" href="GtkActionGroup.html" title="GtkActionGroup"><link rel="refentry" href="GtkAction.html" title="GtkAction"><link rel="refentry" href="GtkToggleAction.html" title="GtkToggleAction"><link rel="refentry" href="GtkRadioAction.html" title="GtkRadioAction"><link rel="chapter" href="SelectorWidgets.html" title="Selectors (File/Font/Color/Input Devices)"><link rel="refentry" href="GtkColorButton.html" title="GtkColorButton"><link rel="refentry" href="GtkColorSelection.html" title="GtkColorSelection"><link rel="refentry" href="GtkColorSelectionDialog.html" title="GtkColorSelectionDialog"><link rel="refentry" href="GtkFileSelection.html" title="GtkFileSelection"><link rel="refentry" href="GtkFileChooser.html" title="GtkFileChooser"><link rel="refentry" href="GtkFileChooserDialog.html" title="GtkFileChooserDialog"><link rel="refentry" href="GtkFileChooserWidget.html" title="GtkFileChooserWidget"><link rel="refentry" href="gtk-gtkfilefilter.html" title="GtkFileFilter"><link rel="refentry" href="GtkFontButton.html" title="GtkFontButton"><link rel="refentry" href="GtkFontSelection.html" title="GtkFontSelection"><link rel="refentry" href="GtkFontSelectionDialog.html" title="GtkFontSelectionDialog"><link rel="refentry" href="GtkInputDialog.html" title="GtkInputDialog"><link rel="chapter" href="LayoutContainers.html" title="Layout Containers"><link rel="refentry" href="GtkAlignment.html" title="GtkAlignment"><link rel="refentry" href="GtkAspectFrame.html" title="GtkAspectFrame"><link rel="refentry" href="GtkHBox.html" title="GtkHBox"><link rel="refentry" href="GtkVBox.html" title="GtkVBox"><link rel="refentry" href="GtkHButtonBox.html" title="GtkHButtonBox"><link rel="refentry" href="GtkVButtonBox.html" title="GtkVButtonBox"><link rel="refentry" href="GtkFixed.html" title="GtkFixed"><link rel="refentry" href="GtkHPaned.html" title="GtkHPaned"><link rel="refentry" href="GtkVPaned.html" title="GtkVPaned"><link rel="refentry" href="GtkLayout.html" title="GtkLayout"><link rel="refentry" href="GtkNotebook.html" title="GtkNotebook"><link rel="refentry" href="GtkTable.html" title="GtkTable"><link rel="refentry" href="GtkExpander.html" title="GtkExpander"><link rel="chapter" href="Ornaments.html" title="Ornaments"><link rel="refentry" href="GtkFrame.html" title="GtkFrame"><link rel="refentry" href="GtkHSeparator.html" title="GtkHSeparator"><link rel="refentry" href="GtkVSeparator.html" title="GtkVSeparator"><link rel="chapter" href="ScrollingWidgets.html" title="Scrolling"><link rel="refentry" href="GtkHScrollbar.html" title="GtkHScrollbar"><link rel="refentry" href="GtkVScrollbar.html" title="GtkVScrollbar"><link rel="refentry" href="GtkScrolledWindow.html" title="GtkScrolledWindow"><link rel="chapter" href="MiscObjects.html" title="Miscellaneous"><link rel="refentry" href="GtkAdjustment.html" title="GtkAdjustment"><link rel="refentry" href="GtkArrow.html" title="GtkArrow"><link rel="refentry" href="GtkCalendar.html" title="GtkCalendar"><link rel="refentry" href="GtkDrawingArea.html" title="GtkDrawingArea"><link rel="refentry" href="GtkEventBox.html" title="GtkEventBox"><link rel="refentry" href="GtkHandleBox.html" title="GtkHandleBox"><link rel="refentry" href="GtkIMContextSimple.html" title="GtkIMContextSimple"><link rel="refentry" href="GtkIMMulticontext.html" title="GtkIMMulticontext"><link rel="refentry" href="GtkSizeGroup.html" title="GtkSizeGroup"><link rel="refentry" href="GtkTooltips.html" title="GtkTooltips"><link rel="refentry" href="GtkViewport.html" title="GtkViewport"><link rel="refentry" href="GtkAccessible.html" title="GtkAccessible"><link rel="chapter" href="AbstractObjects.html" title="Abstract Base Classes"><link rel="refentry" href="GtkBin.html" title="GtkBin"><link rel="refentry" href="GtkBox.html" title="GtkBox"><link rel="refentry" href="GtkButtonBox.html" title="GtkButtonBox"><link rel="refentry" href="GtkContainer.html" title="GtkContainer"><link rel="refentry" href="GtkItem.html" title="GtkItem"><link rel="refentry" href="GtkMisc.html" title="GtkMisc"><link rel="refentry" href="GtkObject.html" title="GtkObject"><link rel="refentry" href="GtkPaned.html" title="GtkPaned"><link rel="refentry" href="GtkRange.html" title="GtkRange"><link rel="refentry" href="GtkScale.html" title="GtkScale"><link rel="refentry" href="GtkScrollbar.html" title="GtkScrollbar"><link rel="refentry" href="GtkSeparator.html" title="GtkSeparator"><link rel="refentry" href="GtkWidget.html" title="GtkWidget"><link rel="refentry" href="GtkIMContext.html" title="GtkIMContext"><link rel="chapter" href="PlugSocket.html" title="Cross-process Embedding"><link rel="refentry" href="GtkPlug.html" title="GtkPlug"><link rel="refentry" href="GtkSocket.html" title="GtkSocket"><link rel="chapter" href="SpecialObjects.html" title="Special-purpose features"><link rel="refentry" href="GtkCurve.html" title="GtkCurve"><link rel="refentry" href="GtkGammaCurve.html" title="GtkGammaCurve"><link rel="refentry" href="GtkRuler.html" title="GtkRuler"><link rel="refentry" href="GtkHRuler.html" title="GtkHRuler"><link rel="refentry" href="GtkVRuler.html" title="GtkVRuler"><link rel="chapter" href="DeprecatedObjects.html" title="Deprecated"><link rel="refentry" href="GtkCList.html" title="GtkCList"><link rel="refentry" href="GtkCTree.html" title="GtkCTree"><link rel="refentry" href="GtkCombo.html" title="GtkCombo"><link rel="refentry" href="GtkItemFactory.html" title="GtkItemFactory"><link rel="refentry" href="GtkList.html" title="GtkList"><link rel="refentry" href="GtkListItem.html" title="GtkListItem"><link rel="refentry" href="GtkOldEditable.html" title="GtkOldEditable"><link rel="refentry" href="GtkOptionMenu.html" title="GtkOptionMenu"><link rel="refentry" href="GtkPixmap.html" title="GtkPixmap"><link rel="refentry" href="GtkPreview.html" title="GtkPreview"><link rel="refentry" href="GtkProgress.html" title="GtkProgress"><link rel="refentry" href="GtkText.html" title="GtkText"><link rel="refentry" href="GtkTipsQuery.html" title="GtkTipsQuery"><link rel="refentry" href="GtkTree.html" title="GtkTree"><link rel="refentry" href="GtkTreeItem.html" title="GtkTreeItem"><link rel="part" href="migrating.html" title="Part IV. Migrating from Previous Versions of GTK+"><link rel="chapter" href="gtk-migrating-checklist.html" title="Migration Checklist"><link rel="refentry" href="gtk-changes-1-2.html" title="Changes from 1.0 to 1.2"><link rel="refentry" href="gtk-changes-2-0.html" title="Changes from 1.2 to 2.0"><link rel="chapter" href="gtk-migrating-GtkFileChooser.html" title="Migrating from GtkFileSelection to GtkFileChooser"><link rel="chapter" href="gtk-migrating-GtkAction.html" title="Migrating from old menu and toolbar systems to GtkAction"><link rel="chapter" href="gtk-migrating-GtkComboBox.html" title="Migrating from GtkOptionMenu and GtkCombo to GtkComboBox and GtkComboBoxEntry"><link rel="part" href="pt05.html" title="Part V. GTK+ Tools"><link rel="refentry" href="gtk-query-immodules-2.0.html" title="gtk-query-immodules-2.0"><link rel="glossary" href="glossary.html" title="Glossary"><link rel="index" href="ix01.html" title="Index"><meta name="generator" content="GTK-Doc V1.2 (XML mode)"><link rel="stylesheet" href="style.css" type="text/css"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table class="navigation" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2"><tr valign="middle"><td><a accesskey="p" href="ui-manager.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td><td><a accesskey="u" href="gtk-migrating-GtkAction.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td><td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td><th width="100%" align="center">GTK+ Reference Manual</th><td><a accesskey="n" href="gtk-migrating-GtkComboBox.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td></tr></table><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="migrating-gnomeuiinfo"></a>Migrating from GnomeUIInfo</h2></div></div><div></div></div><p>
      Prior to GTK+ 2.4, some applications used the GnomeUIInfo
      mechanism from
      <tt class="filename">&lt;libgnomeui/gnome-app-helper.h&gt;</tt> to
      define their menus and toolbars.  With it, a program decleres an
      array of <span class="structname">GnomeUIInfo</span> structures, which
      contain information for menu or toolbar items such as their
      label, icon, and accelerator key.  Then, one calls
      <tt class="function">gnome_app_fill_menu()</tt> or
      <tt class="function">gnome_app_fill_toolbar()</tt>, or one of the
      related functions, to create the appropriate widgets based on
      these structures.
    </p><p>
      A downside of this API is that the same structures are used to
      pass back pointers to the widgets that got created.  This means
      that the structures cannot simply be kept around if the program
      requires multiple instances of the user interface (e.g. several
      windows); each new invocation of
      <tt class="function">gnome_app_fill_menu()</tt> would overwrite the
      widget fields of the structures.
    </p><p>
      Another disadvantage is that there is no automatic way to
      synchronize the state of related controls.  If there are toolbar
      toogle buttons for "Bold", "Italic", "Underline", and also
      corresponding menu items under "Format/Bold", etc., one has to
      synchronize their toggled states by hand whenever the user
      selects any one of them.
    </p><p>
      Finally, there is no way to do menu and toolbar merging for
      applications that require embedded components.
    </p><p>
      To convert an application that uses GnomeUIInfo into the new
      GtkAction mechanism, you need to do several things:
    </p><div class="orderedlist"><ol type="1"><li><p>
	  Separate your existing GnomeUIInfo entries into normal
	  actions, toggle actions, and radio actions, and then create
	  a separate array of <a href="GtkActionGroup.html#GtkActionEntry">GtkActionEntry</a> structures
	  for each group.  This will allow you to create the necessary
	  <a href="GtkActionGroup.html" title="GtkActionGroup">GtkActionGroup</a>
	  objects.  Note that this does not describe the actual
	  "shape" that your menus and toolbars will have; it simply
	  defines the set of commands that will appear in them.
	</p></li><li><p>
	  Create an XML description of your menus and toolbars for use
	  with <a href="GtkUIManager.html" title=" 
GtkUIManager">GtkUIManager</a>.  This
	  defines the actual shape of the menus and toolbars.
	</p></li><li><p>
	  Port the code that uses gnome-app and gnome-app-helper to
	  <a href="GtkAction.html" title="GtkAction">GtkAction</a> and <a href="GtkUIManager.html" title=" 
GtkUIManager">GtkUIManager</a>.
	</p></li></ol></div><div class="example"><a name="gnomeuiinfo-example"></a><p class="title"><b>Example 1. GnomeUIInfo Example</b></p><p>
	The following code shows a declaration of a simple menu bar to
	be used with <tt class="function">gnome_app_fill_menu()</tt> or
	similar.  The menu hierarchy looks like this:
      </p><div class="itemizedlist"><ul type="disc"><li><p><span class="guimenu">File</span></p><table class="simplelist" border="0" summary="Simple list"><tr><td><span class="guimenuitem">Open</span></td></tr><tr><td><span class="guimenuitem">&#8212;</span></td></tr><tr><td><span class="guimenuitem">Exit</span></td></tr></table></li><li><p><span class="guimenu">View</span></p><table class="simplelist" border="0" summary="Simple list"><tr><td><span class="guimenuitem">Zoom In</span></td></tr><tr><td><span class="guimenuitem">Zoom Out</span></td></tr><tr><td><span class="guimenuitem">&#8212;</span></td></tr><tr><td><span class="guimenuitem">[ ] Full Screen</span></td></tr><tr><td><span class="guimenuitem">&#8212;</span></td></tr><tr><td><span class="guimenuitem">( ) High Quality</span></td></tr><tr><td><span class="guimenuitem">( ) Normal Quality</span></td></tr><tr><td><span class="guimenuitem">( ) Low Quality</span></td></tr></table></li></ul></div><pre class="programlisting">
static GnomeUIInfo file_menu_items[] = {
  { GNOME_APP_UI_ITEM, "_Open", "Open a file",
    open_callback, NULL, NULL, GNOME_APP_PIXMAP_STOCK, GTK_STOCK_OPEN,
    'o', GDK_CONTROL_MASK, NULL },
  { GNOME_APP_UI_SEPARATOR },
  { GNOME_APP_UI_ITEM, "E_xit", "Exit the program",
    exit_callback, NULL, NULL, GNOME_APP_PIXMAP_STOCK, GTK_STOCK_QUIT,
    'q', GDK_CONTROL_MASK, NULL},
  { GNOME_APP_UI_ENDOFINFO }
};

static GnomeUIInfo view_radio_items[] = {
  { GNOME_APP_UI_ITEM, "_High Quality", "Display images in high quality, slow mode",
    high_quality_callback, NULL, NULL, GNOME_APP_PIXMAP_NONE, NULL,
    0, 0, NULL },
  { GNOME_APP_UI_ITEM, "_Normal Quality", "Display images in normal quality",
    normal_quality_callback, NULL, NULL, GNOME_APP_PIXMAP_NONE, NULL,
    0, 0, NULL },
  { GNOME_APP_UI_ITEM, "_Low Quality", "Display images in low quality, fast mode",
    low_quality_callback, NULL, NULL, GNOME_APP_PIXMAP_NONE, NULL,
    0, 0, NULL },
  { GNOME_APP_UI_ENDOFINFO }
};

static GnomeUIInfo view_menu_items[] = {
  { GNOME_APP_UI_ITEM, "Zoom _In", "Zoom into the image",
    zoom_in_callback, NULL, NULL, GNOME_APP_PIXMAP_STOCK, GTK_STOCK_ZOOM_IN,
    GDK_PLUS, 0, NULL },
  { GNOME_APP_UI_ITEM, "Zoom _Out", "Zoom away from the image",
    zoom_out_callback, NULL, NULL, GNOME_APP_PIXMAP_STOCK, GTK_STOCK_ZOOM_OUT,
    GDK_MINUS, 0, NULL },
  { GNOME_APP_UI_SEPARATOR },
  { GNOME_APP_UI_TOGGLEITEM, "_Full Screen", "Switch between full screen and windowed mode",
    full_screen_callback, NULL, NULL, GNOME_APP_PIXMAP_NONE, NULL,
    GDK_F11, 0, NULL },
  { GNOME_APP_UI_SEPARATOR },
  { GNOME_APP_UI_RADIOITEMS, NULL, NULL, view_radio_items },
  { GNOME_APP_UI_ENDOFINFO }
};

static GnomeUIInfo menubar[] = {
  { GNOME_APP_UI_SUBTREE, "_File", NULL, file_menu_items },
  { GNOME_APP_UI_SUBTREE, "_View", NULL, view_menu_items },
  { GNOME_APP_UI_ENDOFINFO }
}
      </pre></div><div class="example"><a name="gnomeuiinfo-action-entries"></a><p class="title"><b>Example 2. <span class="structname">GtkActionEntry</span> Structures</b></p><p>
	The following code is the set of actions that are present in
	the <a href="migrating-gnomeuiinfo.html#gnomeuiinfo-example" title="Example 1. GnomeUIInfo Example">previous
	example</a>.  Note that the toggle and radio entries are
	separate from normal actions.  Also, note that <a href="GtkActionGroup.html#GtkActionEntry">GtkActionEntry</a> structures take
	key names in the format of gdk_accelerator_parse() rather than
	key values plus modifiers; you will have to convert these
	values by hand.  For example, <tt class="constant">GDK_F11</tt>
	with no modifiers is equivalent to a key name of
	<tt class="literal">"F11"</tt>.  Likewise, <tt class="literal">"o"</tt>
	with <tt class="constant">GDK_CONTROL_MASK</tt> is equivalent to
	<tt class="literal">"&lt;ontrol&gt;O"</tt>.
      </p><pre class="programlisting">
/* Normal items */
static GtkActionEntry entries[] = {
  { "FileMenu", NULL, "_File" },
  { "ViewMenu", NULL, "_View" },
  { "Open", GTK_STOCK_OPEN, "_Open", "&lt;control&gt;O", "Open a file", open_action_callback },
  { "Exit", GTK_STOCK_OPEN, "E_xit", "&lt;control&gt;Q", "Exit the program", exit_action_callback },
  { "ZoomIn", GTK_STOCK_ZOOM_IN, "Zoom _In", "plus", "Zoom into the image", zoom_in_action_callback },
  { "ZoomOut", GTK_STOCK_ZOOM_OUT, "Zoom _Out", "minus", "Zoom away from the image", zoom_out_action_callback },
};

/* Toggle items */
static GtkToggleActionEntry toggle_entries[] = {
  { "FullScreen", NULL, "_Full Screen", "F11", "Switch between full screen and windowed mode", full_screen_action_callback, FALSE }
};

/* Radio items */
static GtkRadioActionEntry radio_entries[] = {
  { "HighQuality", NULL, "_High Quality", NULL, "Display images in high quality, slow mode", 0 },
  { "NormalQuality", NULL, "_Normal Quality", NULL, "Display images in normal quality", 1 },
  { "LowQuality", NULL, "_Low Quality", NULL, "Display images in low quality, fast mode", 2 }
};
      </pre></div><div class="example"><a name="gnomeuiinfo-xml"></a><p class="title"><b>Example 3. XML Description</b></p><p>
	After extracting the actions, you will need to create an XML
	description of the actual layout of your menus and toolbars
	for use with <a href="GtkUIManager.html" title=" 
GtkUIManager">GtkUIManager</a>.
	The following code shows a simple menu bar that corresponds to
	the <a href="migrating-gnomeuiinfo.html#gnomeuiinfo-example" title="Example 1. GnomeUIInfo Example">previous
	example</a>.  Note that the <span class="guimenu">File</span> and
	<span class="guimenu">View</span> menus have their names specified in
	the <a href="migrating-gnomeuiinfo.html#gnomeuiinfo-action-entries" title="Example 2. GtkActionEntry Structures">action
	entries</a>, not in the XML itself.  This is because the
	XML description only contains <span class="emphasis"><em>identifiers</em></span>
	for the items in the GUI, rather than human-readable names.
      </p><pre class="programlisting">
static const char *ui_description =
"&lt;ui&gt;"
"  &lt;menubar name='MainMenu'&gt;"
"    &lt;menu action='FileMenu'&gt;"
"      &lt;menuitem action='Open'/&gt;"
"      &lt;menuitem action='Exit'/&gt;"
"    &lt;/menu&gt;"
"    &lt;menu action='ViewMenu'&gt;"
"      &lt;menuitem action='ZoomIn'/&gt;"
"      &lt;menuitem action='ZoomOut'/&gt;"
"      &lt;separator/&gt;"
"      &lt;menuitem action='FullScreen'/&gt;"
"      &lt;separator/&gt;"
"      &lt;menuitem action='HighQuality'/&gt;"
"      &lt;menuitem action='NormalQuality'/&gt;"
"      &lt;menuitem action='LowQuality'/&gt;"
"    &lt;/menu&gt;"
"  &lt;/menubar&gt;"
"&lt;/ui&gt;";
      </pre></div><div class="example"><a name="gnomeuiinfo-code"></a><p class="title"><b>Example 4. Creating the Menu Bar</b></p><p>
	In this last example, we will create a <a href="GtkActionGroup.html" title="GtkActionGroup">GtkActionGroup</a> based on the
	<a href="migrating-gnomeuiinfo.html#gnomeuiinfo-action-entries" title="Example 2. GtkActionEntry Structures">action
	entries</a> we created above.  We will then create a <a href="GtkUIManager.html" title=" 
GtkUIManager">GtkUIManager</a> with the <a href="migrating-gnomeuiinfo.html#gnomeuiinfo-xml" title="Example 3. XML Description">XML description</a> of the menu
	layout.  We will also extract the accelerator group and the
	widgets from the <a href="GtkUIManager.html" title=" 
GtkUIManager">GtkUIManager</a> put them into a
	window.
      </p><pre class="programlisting">
GtkWidget *window;
GtkWidget *vbox;
GtkWidget *menubar;
GtkActionGroup *action_group;
GtkUIManager *ui_manager;
GtkAccelGroup *accel_group;
GError *error;

window = gtk_window_new (GTK_WINDOW_TOPLEVEL);

vbox = gtk_vbox_new (FALSE, 0);
gtk_container_add (GTK_CONTAINER (window), vbox);

action_group = gtk_action_group_new ("MenuActions");
gtk_action_group_add_actions (action_group, entries, G_N_ELEMENTS (entries), window);
gtk_action_group_add_toggle_actions (action_group, toggle_entries, G_N_ELEMENTS (toggle_entries), window);
gtk_action_group_add_radio_actions (action_group, radio_entries, G_N_ELEMENTS (radio_entries), 0, radio_action_callback, window);

ui_manager = gtk_ui_manager_new ();
gtk_ui_manager_insert_action_group (ui_manager, action_group, 0);

accel_group = gtk_ui_manager_get_accel_group (ui_manager);
gtk_window_add_accel_group (GTK_WINDOW (window), accel_group);

error = NULL;
if (!gtk_ui_manager_add_ui_from_string (ui_manager, ui_description, -1, &amp;error))
  {
    g_message ("building menus failed: %s", error-&gt;message);
    g_error_free (error);
    exit (EXIT_FAILURE);
  }

menubar = gtk_ui_manager_get_widget (ui_manager, "/MainMenu");
gtk_box_pack_start (GTK_BOX (vbox), menubar, FALSE, FALSE, 0);

gtk_widget_show_all (window);
      </pre></div></div><table class="navigation" width="100%" summary="Navigation footer" cellpadding="2" cellspacing="0"><tr valign="middle"><td align="left"><a accesskey="p" href="ui-manager.html"><b>&lt;&lt; User Interface Manager Object</b></a></td><td align="right"><a accesskey="n" href="gtk-migrating-GtkComboBox.html"><b>Migrating from GtkOptionMenu and GtkCombo to GtkComboBox and GtkComboBoxEntry &gt;&gt;</b></a></td></tr></table></body></html>
