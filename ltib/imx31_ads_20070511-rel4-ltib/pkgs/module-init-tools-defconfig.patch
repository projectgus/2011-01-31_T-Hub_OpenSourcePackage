--- module-init-tools-3.1-pre5/modprobe.c.dist	2004-06-20 05:34:34.000000000 -0400
+++ module-init-tools-3.1-pre5/modprobe.c	2004-09-01 12:57:26.214587739 -0400
@@ -59,6 +59,10 @@
 #define MODULE_DIR "/lib/modules"
 #endif
 
+#define DEFAULT_CONFIG "/etc/modprobe.conf"
+#define DIST_CONFIG "/etc/modprobe.conf.dist"
+#define MODPROBE_DEVFSD_CONF "/etc/modprobe.devfs"
+
 typedef void (*errfn_t)(const char *fmt, ...);
 
 /* Do we use syslog or stderr for messages? */
@@ -971,7 +975,12 @@
 	char *line;
 	unsigned int linenum = 0;
 	FILE *cfile;
+ 	char *result = NULL;
 
+	if (!strcmp(filename, DEFAULT_CONFIG))
+		result = read_config(DIST_CONFIG, name,
+				     dump_only, removing,
+				     options, commands, alias);
 	cfile = fopen(filename, "r");
 	if (!cfile)
 		return 0;
@@ -1209,7 +1218,6 @@
 				   { "first-time", 0, NULL, 3 },
 				   { NULL, 0, NULL, 0 } };
 
-#define MODPROBE_DEVFSD_CONF "/etc/modprobe.devfs"
 
 /* This is a horrible hack to allow devfsd, which calls modprobe with
    -C /etc/modules.conf or /etc/modules.devfs, to work.  FIXME. */
